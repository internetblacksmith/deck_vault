<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "MTG Collector" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="MTG Collector">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <%# Tailwind CSS with config -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            colors: {
              mtg: {
                primary: '#1a1f36',
                secondary: '#5b21b6',
                accent: '#8b5cf6',
              }
            },
            animation: {
              shimmer: 'shimmer 2s infinite',
              pulse: 'pulse 2s infinite',
            }
          }
        }
      }
    </script>
    <style>
      @keyframes shimmer {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
      }
      body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
      .glass { backdrop-filter: blur(12px); background: rgba(255, 255, 255, 0.1); }
      .gradient-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
      .gradient-accent { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
      
      /* Dark mode styles */
      :root {
        color-scheme: light;
      }
      
      .dark {
        color-scheme: dark;
      }
      
      .dark body {
        @apply bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950;
      }
      
      .dark .glass {
        background: rgba(0, 0, 0, 0.3);
      }
    </style>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white min-h-screen">
    <!-- Navigation -->
    <nav class="border-b border-purple-500/20 sticky top-0 z-50 glass">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
        <div class="flex justify-between items-center">
          <div class="flex items-center space-x-3">
            <div class="w-10 h-10 gradient-accent rounded-lg flex items-center justify-center">
              <span class="text-lg font-bold">‚öîÔ∏è</span>
            </div>
            <div>
              <h1 class="text-2xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent">
                <%= link_to "MTG Collector", card_sets_path, class: "hover:opacity-80 transition" %>
              </h1>
              <p class="text-xs text-purple-300">Manage Your Collection</p>
            </div>
          </div>
           <div class="flex items-center space-x-4">
             <button data-controller="dark-mode" data-action="dark-mode#toggle" 
                     data-dark-mode-target="toggle"
                     class="text-xl hover:scale-110 transition-transform duration-200 p-2 rounded-lg hover:bg-purple-500/20"
                     aria-label="Toggle dark mode">
               üåô
             </button>
             <%= link_to "Home", card_sets_path, class: "text-sm text-purple-300 hover:text-purple-100 transition" %>
           </div>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="min-h-screen">
      <%= yield %>
    </main>

    <!-- Footer -->
    <footer class="border-t border-purple-500/20 mt-16">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <p class="text-center text-purple-300 text-sm">MTG Collector ‚Ä¢ Built with Rails & Tailwind</p>
      </div>
    </footer>
  </body>
</html>
